<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script
      src="https://activity.hdslb.com/blackboard/static/20220211/00979505aec5edd6e5c2f8c096fa0f62/RPVEUNWPF0.js"
      crossorigin="anonymous"
    ></script>
    <script>
      const { Engine, Render, Bodies, Body, Composite, Events } = Matter
      // create an engine
      var engine = Engine.create()

      // create a renderer
      var render = Render.create({
        element: document.body,
        engine: engine
      })

      const position = { x: 400, y: 200 }
      const size = { x: 40, y: 78 }

      // create two boxes and a ground
      var boxA = Bodies.rectangle(position.x, position.y, size.x, size.y, {
        inertia: Infinity,
        label: 'A',
        collisionFilter: {
          category: 1,
          mask: 1 | 4
        }
      })
      var boxB = Bodies.rectangle(
        position.x,
        position.y + size.y / 4 + 10,
        size.x - 10,
        size.y / 2,
        {
          inertia: Infinity,
          isSensor: true,
          // isStatic: true,
          label: 'B',
          collisionFilter: {
            category: 2,
            mask: 2 | 4
          }
        }
      )

      var ground = Bodies.rectangle(400, 550, 800, -100, {
        isStatic: true,
        label: 'G',
        collisionFilter: {
          category: 4,
          mask: 1 | 2 | 4
        }
      })

      Composite.add(engine.world, [boxA, boxB, ground])

      Render.run(render)

      let lastT = performance.now()
      let raf = NaN
      const af = t => {
        const deltaT = t - lastT
        lastT = t
        raf = requestAnimationFrame(af)
        Body.setPosition(boxB, { x: boxA.position.x, y: boxA.position.y + size.y / 4 + 10 })
        Body.setVelocity(boxB, { x: 0, y: 0 })

        Engine.update(engine, deltaT)
      }
      raf = requestAnimationFrame(af)

      Events.on(engine, 'collisionStart', event => {
        event.pairs.forEach(p => {
          console.log(p.bodyA.label, p.bodyB.label)
        })
      })
    </script>
  </body>
</html>
